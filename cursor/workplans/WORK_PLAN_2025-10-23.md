# 🏁 Sydney Milestone Workplan

**Milestone:** Sydney (#14)  
**Due Date:** October 25, 2025  
**Status:** 58% complete  
**Objective:** Deliver the **Race-Crew Web UI** (Epic #279) with unified Cloud Run behavior, interactive visualization, and stable developer pipelines.

## 📈 Summary Table

| Order | Issue                      | Category | Effort | Priority | Status       |
| :---: | :------------------------- | :------- | :----- | :------- | :----------- |
|   1   | #319 Enable Bin Dataset    | Bug Fix  | XS     | P0       | 🟢 Ready     |
|   2   | #296 CI Noise Reduction    | DX       | S      | P1       | 🟡 Ready     |
|   3   | #314 Password Gate         | Feature  | M      | P1       | 🟢 Open      |
|   4   | #317 Segments Map          | Feature  | M      | P1       | 🟢 Open      |
|   5   | #280 Density Heatmaps      | Feature  | M      | P1       | 🟢 Open      |
|   6   | #318 Bin-Level Table       | Feature  | S      | P1       | 🟢 Open      |
|   7   | #279 Epic Integration      | Meta     | M-L    | P2       | 🟠 Pending   |
|   -   | #315 Cloud Report v2 Fix   | Cleanup  | M      | P2       | 🔴 Deferred  |

---

## 🔹 Phase 1 — Quick Wins & Stabilization

*Immediate, low-risk items that unblock Cloud parity and CI efficiency.*

### ✅ 1. #319 – Enable Bin Dataset by Default (Quick Fix)

* **Goal:** Flip `enable_bin_dataset` flag from `False` to `True` in `new_density_report.py`.
* **Changes:**

  * Change default flag value (single line change)
  * Verify bin artifacts exist in both local and Cloud environments
  * Add logging to confirm enabled behavior
* **Effort:** XS (≤ 30 minutes)
* **Priority:** P0
* **Outcome:** All Cloud and local runs generate consistent v2 reports with bin-level details.
* **Rationale:** Architectural review revealed this achieves same outcome as #315 with 50% less work and risk.

**Note:** Issue #315 (API import restructuring) deferred to post-Sydney for code cleanup.

### 🧹 2. #296 – Reduce CI Workflow Noise on PRs

* **Goal:** Simplify GitHub Actions to prevent duplicate runs and email spam.
* **Changes:**

  * Consolidate `build` + `test` workflows.
  * Add `if: github.event.pull_request.draft != true`.
  * Disable redundant status checks.
* **Effort:** S (1–2 hours)
* **Priority:** P1
* **Outcome:** Cleaner CI signals and faster PR feedback loops.

---

## 🔹 Phase 2 — Core Epic Features ( #279 : Race-Crew Web UI )

*All remaining front-end & auth components built against the new StorageService backend.*

### 🔐 3. #314 – Password Gate with Session Management ( 279-1 )

* **Goal:** Implement auth middleware for Race-Crew dashboard.
* **Tasks:**

  * Use FastAPI SessionMiddleware + signed cookie.
  * Add simple login form (front-end).
* **Effort:** M (1 day)
* **Dependency:** None.
* **Outcome:** Dashboard secured behind login gate.

### 🗺️ 4. #317 – Implement Segments Map (Leaflet visualization) ( 279-2 )

* **Goal:** Render segments.geojson from StorageService onto Leaflet map.
* **Tasks:**

  * Use `StorageService.read_geojson()`.
  * Integrate interactive hover tooltips + filter controls.
* **Effort:** M (1 day)
* **Dependency:** Optional #314 (auth).
* **Outcome:** Interactive map for segment visualization.

### 🔥 5. #280 – Density Heatmaps Visualization ( 279-3 )

* **Goal:** Generate and display density heatmaps from `bins.parquet`.
* **Tasks:**

  * Use `StorageService.read_parquet()`.
  * Render static PNG heatmaps or interactive canvas overlay.
* **Effort:** M (1–2 days).
* **Dependency:** Storage migration (#298) ✅.
* **Outcome:** Heatmap view with consistent Cloud data.

### 📊 6. #318 – Implement Bin-Level Details Table ( 279-4 )

* **Goal:** Tabular details per segment bin (utilization, flags, metrics).
* **Tasks:**

  * Reuse existing Density API response.
  * Display sortable table in UI.
* **Effort:** S (½ day).
* **Dependency:** #280.
* **Outcome:** Detailed table complementing heatmap visualization.

---

## 🔹 Phase 3 — Integration & QA ( #279 )

*Final integration of Race-Crew UI and Cloud verification.*

### 🧩 7. #279 – Epic Integration and Polish

* **Goal:** Integrate auth, map, heatmap, and table modules into final Race-Crew UI.
* **Tasks:**

  * Merge and test all features locally and in Cloud Run.
  * Verify data flow and route auth.
  * Resolve UI styling issues.
* **Effort:** M–L (1–2 days).
* **Outcome:** Stable, interactive Race-Crew Web UI release.

---

## ⚙️ Execution Guidelines for Cursor

* **Branching:** Create per-issue branches (e.g. `feat/315-density-v2`, `feat/317-segments-map`).
* **Order:** Work strictly top-to-bottom unless blocked.
* **After Each PR:**

  * Comment in GitHub issue: "✅ Verified in Cloud Run."
  * Close issue on merge.
* **Testing:** Prefer Cloud Run validation for #319 and #279.
* **Parallelization:** #317 and #280 may run concurrently after #314 completes.

---

## 📝 Notes

**Created:** October 23, 2025  
**Updated:** October 23, 2025 (Issue #319 replaces #315 for quick fix)  
**Source:** ChatGPT (Senior Technical Architect role)  
**Context:** Post-GitHub issue review session  
**Related Issues:** Epic #279, Issues #280, #296, #314, #317, #318, #319
**Deferred Issues:** #315 (API restructuring - post-Sydney cleanup)

---

## 🎯 Success Criteria

**Phase 1 Complete:**
- ✅ Cloud Run generates v2 density reports
- ✅ CI workflow noise reduced by 60%+

**Phase 2 Complete:**
- ✅ Auth gate protects dashboard
- ✅ Interactive segments map live
- ✅ Density heatmaps visible
- ✅ Bin-level details table functional

**Phase 3 Complete:**
- ✅ All features integrated and tested
- ✅ Cloud Run validation passing
- ✅ Epic #279 closed
- ✅ Sydney milestone 100% complete

---

## ⚠️ Risk Mitigation

**Blocker Risks:**
1. **#319 (P0)** - Must complete first; blocks Cloud parity (30 min fix)
2. **Storage Service** - Already migrated (#298 ✅), reduces integration risk
3. **Auth Implementation** - May require session storage strategy decision

**Mitigation Strategies:**
- Tackle P0 items immediately
- Parallelize independent features (#317, #280)
- Maintain clean branch strategy for easy rollbacks
- Test in Cloud Run after each merge

---

## 🔄 Progress Tracking

Update this section as work completes:

- [ ] Phase 1: Quick Wins (Items 1-2)
- [ ] Phase 2: Core Features (Items 3-6)
- [ ] Phase 3: Integration (Item 7)

**Last Updated:** October 23, 2025 - 14:45 EDT

---

## 📋 Strategic Changes Log

### Issue #315 → #319 Swap (Oct 23, 14:45)

**Decision:** After architectural review with ChatGPT, replaced #315 with simpler #319.

**Original Plan (#315):**
- Update `main.py` imports to use `new_density_report.py`
- Add compatibility wrappers
- Restructure API routing
- Effort: 1 hour
- Risk: Low but requires testing multiple code paths

**New Plan (#319):**
- Flip `enable_bin_dataset` default flag from `False` to `True`
- Single line change in `new_density_report.py`
- Effort: 30 minutes
- Risk: Very low (artifacts already exist per #298)

**Why Better:**
- 50% faster implementation
- Same user-facing outcome
- Bin artifacts already generated in all environments
- Resource constraints resolved in Oct 2025 refactor
- #315 remains open for future API cleanup work

**Last Updated:** October 23, 2025

