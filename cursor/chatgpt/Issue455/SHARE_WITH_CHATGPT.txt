================================================================================
CHATGPT REVIEW REQUEST - Issue #455 Phase 3 GCS Implementation
================================================================================

BACKGROUND:
-----------
Issue #455 (UUID-based write path refactor) has successfully implemented
local filesystem storage with the new runflow/<uuid>/ structure. However,
GCS uploads are still using legacy paths. We need guidance on how to
elegantly implement GCS uploads to match the local structure.

WHAT TO REVIEW:
---------------
1. START HERE: Read "phase3-gcs-review.md" (primary review document)
   - Current status and problem statement
   - Detailed questions in Sections A, B, C

2. REFERENCE: Read "implementation-example.md" (code patterns)
   - Shows successful local filesystem implementation
   - Proposes two GCS options (A and B) for evaluation

3. EXAMINE: Review implementation files as needed
   - env.py - Canonical detection functions
   - report_utils.py - Path construction utilities
   - gcs_uploader.py, storage_service.py, storage.py - Need refactoring
   - env-detection.md - Architecture documentation

WHAT WE NEED:
-------------
A) Validate local filesystem implementation is sound
B) Recommend architectural approach for GCS implementation
C) Outline minimal changes needed to achieve parity
D) Suggest specific functions/modules to modify
E) Propose validation strategy for GCS vs local comparison

CURRENT STATUS:
---------------
✅ Local Mode (e2e-local-docker): 35 files in runflow/<uuid>/ structure
❌ GCS Mode (e2e-staging-docker): Files going to wrong legacy paths

EXPECTED RESULT:
----------------
After implementing ChatGPT guidance:
- GCS bucket "runflow" contains run directory with UUID
- Directory structure matches local filesystem exactly
- All 35 files present in correct categories
- No files in legacy "run-density-reports" bucket paths

CONSTRAINTS:
------------
- Keep changes surgical (avoid over-refactoring)
- Use canonical detect_storage_target() from env.py
- New bucket: gs://runflow/
- Issue #455 already has 25 commits
- Want minimal changes to complete Phase 3

FILES IN THIS PACKAGE:
----------------------
- README.md (9KB) - This overview
- phase3-gcs-review.md (21KB) - Primary review document with detailed questions
- implementation-example.md (12KB) - Code patterns and examples
- env-detection.md (17KB) - Architecture documentation
- env.py, report_utils.py - Current working implementations
- gcs_uploader.py, storage_service.py, storage.py - Need refactoring

TOTAL SIZE: 136KB

START WITH: phase3-gcs-review.md
================================================================================
