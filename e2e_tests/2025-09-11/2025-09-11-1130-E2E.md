# End-to-End Testing Report

**Generated:** 2025-09-11 11:30:00

**Environment:** http://testserver:8080 (local TestClient)

**Version:** v1.6.15

**Test Type:** Streamlined End-to-End Testing

**Overall Status:** ✅ PASSED

## Test Summary

| Test Category | Status | Details |
|---------------|--------|---------|
| API Endpoints | ✅ PASSED | All API endpoints responding correctly |
| Report Files | ✅ PASSED | All required report files generated |
| Actual vs Expected | ✅ PASSED | Validation: 29/29 segments (100.0% success) |
| Content Quality | ✅ PASSED | Report content validation |

## Files Created

- `reports/2025-09-11/2025-09-11-1131-Flow.md`
- `reports/2025-09-11/2025-09-11-1131-Flow.csv`
- `reports/2025-09-11/2025-09-11-1130-Density.md`

## Detailed Test Results

### API Endpoint Testing

- **health**: ✅ PASSED
- **ready**: ✅ PASSED
- **density_report**: ✅ PASSED
- **temporal_flow_report**: ✅ PASSED
- **temporal_flow**: ✅ PASSED

### Report File Testing

- **temporal_flow_md**: ✅ PASSED
- **temporal_flow_csv**: ✅ PASSED
- **density_md**: ✅ PASSED

### Content Quality Testing

#### Temporal Flow

- ✅ Proper event names (10K Range, Half Range)
- ✅ No generic names (Event A Range)
- ✅ No NaN values

#### Density

- ✅ Proper segment names (A1: Start to Queen/Regent)
- ✅ No unknown segments
- ✅ Proper counts (Total Segments: 22)


## Raw Test Output

<details>
<summary>Click to view raw terminal output</summary>

```
=== STREAMLINED END-TO-END TESTING ===
Testing core API endpoints and report generation (Flow + Density only)

=== PREFLIGHT VALIDATION ===

✅ Preflight validation passed: 53 checks passed
   File: data/segments.csv
   Rows: 22, Columns: 27
=== API ENDPOINT TESTING ===

1. Testing Health and Ready Endpoints...
   /health: 200 ✅
   /ready: 200 ✅

2. Testing Report Generation Endpoints...
🔍 Starting density analysis...
🔍 Analysis results keys: ['summary', 'segments']
🔍 Analysis ok status: NOT_FOUND
🔍 Segments type: <class 'dict'>
🔍 Segment keys: ['A1', 'A2', 'A3']...
🔍 First segment type: <class 'dict'>
🔍 First segment keys: ['summary', 'time_series', 'sustained_periods', 'events_included', 'seg_label', 'per_event']
📊 Density report saved to: reports/2025-09-11/2025-09-11-1130-Density.md
🔍 Starting temporal flow analysis...
🔧 BINNING APPLIED to B1: time_bins=False, distance_bins=True
   Overlap: 8.9min, Conflict: 150m
🔧 BINNING APPLIED to B2: time_bins=True, distance_bins=True
   Overlap: 32.2min, Conflict: 150m
🔧 BINNING APPLIED to B3: time_bins=False, distance_bins=True
   Overlap: 3.7min, Conflict: 150m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 40.9min, Conflict: 200m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 53.9min, Conflict: 200m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 55.5min, Conflict: 200m
✅ High overtaking rates in F1: 76.1%, 73.0% - BINNING APPLIED
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 91.1min, Conflict: 150m
✅ High overtaking rates in H1: 55.2%, 47.3% - BINNING APPLIED
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 53.0min, Conflict: 150m
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 29.4min, Conflict: 150m
🔧 BINNING APPLIED to I1: time_bins=True, distance_bins=True
   Overlap: 86.6min, Conflict: 200m
🔧 BINNING APPLIED to J1: time_bins=True, distance_bins=True
   Overlap: 98.0min, Conflict: 200m
🔧 BINNING APPLIED to J4: time_bins=True, distance_bins=True
   Overlap: 109.9min, Conflict: 200m
🔧 BINNING APPLIED to J5: time_bins=True, distance_bins=True
   Overlap: 77.0min, Conflict: 200m
🔧 BINNING APPLIED to K1: time_bins=True, distance_bins=True
   Overlap: 142.7min, Conflict: 200m
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 65.9min, Conflict: 150m
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 64.8min, Conflict: 150m
✅ High overtaking rates in L1: 56.0%, 35.1% - BINNING APPLIED
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 29.4min, Conflict: 150m
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 62.1min, Conflict: 100m
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 61.3min, Conflict: 100m
🔍 M1 Half vs 10K MAIN ANALYSIS TRACE:
  Input data: A=912 runners, B=618 runners
  Segment boundaries: A=[20.85, 21.1], B=[9.75, 10.0]
  Convergence point: 20.85 km
  Dynamic conflict length: 100.0 m
  Overlap duration: 26.483333333333334 min
  Raw calculation results: 17/12
  Co-presence: 17/12
  Unique encounters: 55
  Participants involved: 29
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 26.5min, Conflict: 100m
📊 Temporal flow report saved to: reports/2025-09-11/2025-09-11-1131-Flow.md
📊 Temporal flow analysis exported to: reports/2025-09-11/2025-09-11-1131-Flow.csv
ℹ️  No Flow Audit data to export
🔧 BINNING APPLIED to B1: time_bins=False, distance_bins=True
   Overlap: 8.9min, Conflict: 150m
🔧 BINNING APPLIED to B2: time_bins=True, distance_bins=True
   Overlap: 32.2min, Conflict: 150m
🔧 BINNING APPLIED to B3: time_bins=False, distance_bins=True
   Overlap: 3.7min, Conflict: 150m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 40.9min, Conflict: 200m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 53.9min, Conflict: 200m
🔧 BINNING APPLIED to F1: time_bins=True, distance_bins=True
   Overlap: 55.5min, Conflict: 200m
✅ High overtaking rates in F1: 76.1%, 73.0% - BINNING APPLIED
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 91.1min, Conflict: 150m
✅ High overtaking rates in H1: 55.2%, 47.3% - BINNING APPLIED
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 53.0min, Conflict: 150m
🔧 BINNING APPLIED to H1: time_bins=True, distance_bins=True
   Overlap: 29.4min, Conflict: 150m
🔧 BINNING APPLIED to I1: time_bins=True, distance_bins=True
   Overlap: 86.6min, Conflict: 200m
🔧 BINNING APPLIED to J1: time_bins=True, distance_bins=True
   Overlap: 98.0min, Conflict: 200m
🔧 BINNING APPLIED to J4: time_bins=True, distance_bins=True
   Overlap: 109.9min, Conflict: 200m
🔧 BINNING APPLIED to J5: time_bins=True, distance_bins=True
   Overlap: 77.0min, Conflict: 200m
🔧 BINNING APPLIED to K1: time_bins=True, distance_bins=True
   Overlap: 142.7min, Conflict: 200m
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 65.9min, Conflict: 150m
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 64.8min, Conflict: 150m
✅ High overtaking rates in L1: 56.0%, 35.1% - BINNING APPLIED
🔧 BINNING APPLIED to L1: time_bins=True, distance_bins=True
   Overlap: 29.4min, Conflict: 150m
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 62.1min, Conflict: 100m
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 61.3min, Conflict: 100m
🔍 M1 Half vs 10K MAIN ANALYSIS TRACE:
  Input data: A=912 runners, B=618 runners
  Segment boundaries: A=[20.85, 21.1], B=[9.75, 10.0]
  Convergence point: 20.85 km
  Dynamic conflict length: 100.0 m
  Overlap duration: 26.483333333333334 min
  Raw calculation results: 17/12
  Co-presence: 17/12
  Unique encounters: 55
  Participants involved: 29
🔧 BINNING APPLIED to M1: time_bins=True, distance_bins=False
   Overlap: 26.5min, Conflict: 100m
   /api/density-report: 200 ✅
   /api/temporal-flow-report: 200 ✅
   /api/temporal-flow: 200 ✅

API Endpoint Testing: ✅ ALL PASSED

=== REPORT FILE TESTING ===

1. Temporal Flow MD files: ✅
2. Temporal Flow CSV files: ✅
3. Density Analysis MD files: ✅

Report File Testing: ✅ ALL PASSED

=== REPORT CONTENT QUALITY TESTING ===

1. Testing Temporal Flow Report Content...
   Proper event names (10K Range, Half Range): ✅
   No generic names (Event A Range): ✅
   No NaN values: ✅

2. Testing Density Analysis Report Content...
   Proper segment names (A1: Start to Queen/Regent): ✅
   No unknown segments: ✅
   Proper counts (Total Segments: 22): ✅ (Density analyzes physical course segments, while Flow analyzes runner pairs - hence different counts)

3. Testing Actual vs Expected Flow Results Validation...
   Validating Actual vs Expected Flow Results:
   ================================================================================
   ✅ MATCH A1, Start to Queen/Regent, Full vs Half, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A1, Start to Queen/Regent, Full vs 10K, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A1, Start to Queen/Regent, Half vs 10K, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A2, Queen/Regent to WSB mid-point, Full vs Half, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A2, Queen/Regent to WSB mid-point, Full vs 10K, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A2, Queen/Regent to WSB mid-point, Half vs 10K, overtake, 34/1, 34/1, 3.7/0.2, 3.7/0.2
   ✅ MATCH A3, WSB mid-point to Friel, Full vs Half, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A3, WSB mid-point to Friel, Full vs 10K, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH A3, WSB mid-point to Friel, Half vs 10K, overtake, 128/13, 128/13, 14.0/2.1, 14.0/2.1
   ✅ MATCH B1, Friel to 10K Turn, Full vs 10K, overtake, 11/16, 11/16, 3.0/2.6, 3.0/2.6
   ✅ MATCH B2, 10K Turn to Friel, Full vs 10K, overtake, 81/56, 81/56, 22.0/9.1, 22.0/9.1
   ✅ NO OVERTAKING (as expected) B3, 10K Turn to Friel, Full vs 10K, none
   ✅ MATCH F1, Friel to Station Rd., Full vs Half, merge, 52/56, 52/56, 14.1/6.1, 14.1/6.1
   ✅ MATCH F1, Friel to Station Rd., Full vs 10K, merge, 171/122, 171/122, 46.5/19.7, 46.5/19.7
   ✅ MATCH F1, Friel to Station Rd., Half vs 10K, merge, 694/451, 694/451, 76.1/73.0, 76.1/73.0
   ✅ MATCH H1, Trail/Aberdeen to/from Station Rd, Full vs Half, counterflow, 203/431, 203/431, 55.2/47.3, 55.2/47.3
   ✅ MATCH H1, Trail/Aberdeen to/from Station Rd, Full vs 10K, counterflow, 119/87, 119/87, 32.3/14.1, 32.3/14.1
   ✅ MATCH H1, Trail/Aberdeen to/from Station Rd, Half vs 10K, counterflow, 11/10, 11/10, 1.2/1.6, 1.2/1.6
   ✅ MATCH I1, Station Rd to Bridge/Mill, Full vs Half, counterflow, 42/9, 42/9, 11.4/1.0, 11.4/1.0
   ✅ MATCH J1, Bridge/Mill to Half Turn (Outbound), Full vs Half, counterflow, 147/209, 147/209, 39.9/22.9, 39.9/22.9
   ✅ MATCH J4, Half Turn to Bridge/Mill, Full vs Half, counterflow, 130/170, 130/170, 35.3/18.6, 35.3/18.6
   ✅ MATCH J5, Half Turn to Bridge/Mill (Slow Half), Full vs Half, counterflow, 45/24, 45/24, 12.2/2.6, 12.2/2.6
   ✅ MATCH K1, Bridge/Mill to Station Rd, Full vs Half, counterflow, 180/244, 180/244, 48.9/26.8, 48.9/26.8
   ✅ MATCH L1, Trail/Aberdeen to/from Station Rd, Full vs Half, overtake, 0/0, 0/0, 0.0/0.0, 0.0/0.0
   ✅ MATCH L1, Trail/Aberdeen to/from Station Rd, Full vs 10K, overtake, 206/217, 206/217, 56.0/35.1, 56.0/35.1
   ✅ MATCH L1, Trail/Aberdeen to/from Station Rd, Half vs 10K, overtake, 11/10, 11/10, 1.2/1.6, 1.2/1.6
   ✅ MATCH M1, Trail/Aberdeen to Finish (Full to Loop), Full vs Half, overtake, 66/96, 66/96, 17.9/10.5, 17.9/10.5
   ✅ MATCH M1, Trail/Aberdeen to Finish (Full to Loop), Full vs 10K, overtake, 124/141, 124/141, 33.7/22.8, 33.7/22.8
   ✅ MATCH M1, Trail/Aberdeen to Finish (Full to Loop), Half vs 10K, overtake, 17/12, 17/12, 1.9/1.9, 1.9/1.9
   ================================================================================
   Overall Validation: ✅ ALL MATCH

Overall Report Quality: ✅ EXCELLENT

=== FINAL SUMMARY ===
Date: 2025-09-11-1133
Environment: http://testserver:8080 (local TestClient)
Version: v1.6.15
API Endpoints: ✅ PASSED
Report Files: ✅ PASSED
   Files Created:
   - reports/2025-09-11/2025-09-11-1131-Flow.md
   - reports/2025-09-11/2025-09-11-1131-Flow.csv
   - reports/2025-09-11/2025-09-11-1130-Density.md
Actual to Expected: ✅ PASSED (Validation: 29/29 segments, 100.0% success)
Content Quality: ✅ PASSED

🎉 STREAMLINED TESTS PASSED! Core system is ready!

📝 NOTE: Flow Runner detailed analysis is not included in automated tests due to computational requirements.
   Flow Runner reports can be run locally (not currently supported in production) using:
   curl -X POST 'http://localhost:8080/api/flow-audit' \
     -H 'Content-Type: application/json' \
     -d '{"paceCsv": "data/runners.csv", "segmentsCsv": "data/segments.csv", "startTimes": {"Full": 420, "10K": 440, "Half": 460}}'

=== STREAMLINED END-TO-END TESTING COMPLETE ===

```

</details>

## Important Notes

📝 **Flow Runner Analysis**: Flow Runner detailed analysis is not included in automated tests due to computational requirements. Flow Runner reports can be run locally (not currently supported in production) using:

```bash
curl -X POST 'http://localhost:8080/api/flow-audit' \
  -H 'Content-Type: application/json' \
  -d '{"paceCsv": "data/runners.csv", "segmentsCsv": "data/segments.csv", "startTimes": {"Full": 420, "10K": 440, "Half": 460}}'
```

## Conclusion

🎉 All tests passed! The system is ready for production deployment.

---
*Report generated by run-density end-to-end testing suite*
